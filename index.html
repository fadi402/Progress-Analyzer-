<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Spider Walk</title>
<style>
  html, body { margin:0; padding:0; overflow:hidden; background:#111; }
  canvas { display:block; }
</style>
</head>
<body>

<script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.158.0/examples/js/loaders/GLTFLoader.js"></script>

<script>
/* ================= SCENE & CAMERA ================= */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);

const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.set(0, 8, 10);  // top-side angle
camera.lookAt(0,0,0);

/* ================= RENDERER ================= */
const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
document.body.appendChild(renderer.domElement);

/* ================= LIGHTS ================= */
scene.add(new THREE.AmbientLight(0xffffff, 0.6));
const dirLight = new THREE.DirectionalLight(0xffffff, 1);
dirLight.position.set(5, 10, 5);
scene.add(dirLight);

/* ================= FLOOR (REFERENCE) ================= */
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(50,50),
  new THREE.MeshStandardMaterial({ color:0x222222 })
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

/* ================= SPIDER ================= */
let spider, mixer;
const clock = new THREE.Clock();

const loader = new THREE.GLTFLoader();
loader.load(
  "animated_spider.glb",
  (gltf) => {
    spider = gltf.scene;
    spider.scale.set(1.5,1.5,1.5);
    spider.position.set(-6,0,0);
    spider.rotation.y = Math.PI/2; // walking forward

    scene.add(spider);

    mixer = new THREE.AnimationMixer(spider);
    gltf.animations.forEach((clip) => {
      mixer.clipAction(clip).play();
    });
  },
  undefined,
  (err) => { console.error("GLB load error:", err); }
);

/* ================= WALK ================= */
const WALK_SPEED = 0.03;
const LIMIT = 6;

/* ================= ANIMATE ================= */
function animate() {
  requestAnimationFrame(animate);
  const delta = clock.getDelta();

  if(mixer) mixer.update(delta);

  if(spider){
    spider.position.x += WALK_SPEED;
    if(spider.position.x > LIMIT) spider.position.x = -LIMIT;
  }

  renderer.render(scene, camera);
}
animate();

/* ================= RESIZE ================= */
window.addEventListener("resize", ()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
